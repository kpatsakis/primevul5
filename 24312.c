static inline int sign(long a)
{
  return a < 0 ? -1 : (a > 0 ? 1 : 0);
}